<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Check List</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./style.css">
  <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>

  <style>
    body { font-family:sans-serif; }
  </style>
</head>
<body class="bg-gray-100 p-6 h-full mt-50">

  <div class="max-w-4xl mx-auto bg-white shadow-lg rounded-lg p-6 div my-8">
    <img style="width: 300px;" src="https://marketing.uz/uploads/articles/5412/article-original.png" alt="">
    <h1 class="text-2xl font-bold text-center mb-2.5 mt-2.5">CHECK LIST O'QITUVCHI</h1>
    
    <form id="checklist-form" onsubmit="submitForm(event)" class="space-y-6">
      <div class="grid grid-cols-2 gap-6">
        <!-- Левый столбец с вопросами -->
        <div class="space-y-4">
          <div>
            <label class="block font-medium text-gray-700">F.I.O</label>
            <input type="text" name="name" class="w-full border rounded px-3 py-1.5" required>
          </div>

          <div class="flex gap-4">
            <div class="w-1/2">
              <label class="block font-medium text-gray-700">Kelish</label>
              <input type="time" name="arrival_time" class="w-full border rounded px-3 py-1.5" required>
            </div>
            <div class="w-1/2">
              <label class="block font-medium text-gray-700">Ketish</label>
              <input required type="time" name="leave_time" class="w-full border rounded px-3 py-1.5" required>
            </div>
          </div>

          <div>
            <label class="block font-medium text-gray-700">Bugun qanday kamchiliklar yuz berdi?</label>
            <input required type="text" name="negatives" class="w-full border rounded px-3 py-1.5">
          </div>

          <div>
            <label class="block font-medium text-gray-700">Bugun qanday qo'shimcha ish qildingiz? </label>
            <input required type="text" name="additional" class="w-full border rounded px-3 py-1.5">
          </div>
          <div>
            <label class="block font-medium text-gray-700">Bugungi kun uchun yutug'ingizni yozing. </label>
            <input required type="text" name="wins" class="w-full border rounded px-3 py-1.5">
          </div>
          <div>
            <label class="block font-medium text-gray-700">Bugun qaysi hamkasbingizga yordam berdingiz? </label>
            <input required type="text" name="support" class="w-full border rounded px-3 py-1.5">
          </div>
          
        </div>

        <div class="space-y-4">
          <div class="flex items-center justify-between">
            <label class="font-medium text-gray-700">O'zingizga qarab keldingizmi? <br></label>
            <input  type="checkbox" name="neatness" class="form-checkbox h-5 w-5 text-blue-600">
          </div>
          <div class="flex items-center justify-between">
            <label class="font-medium text-gray-700">Formada keldingizmi? <br></label>
            <input  type="checkbox" name="clothes" class="form-checkbox h-5 w-5 text-blue-600">
          </div>

          <div class="flex items-center justify-between">
            <label class="font-medium text-gray-700">Ofisda doimo tabassumda yuripsizmi?</label>
            <input  type="checkbox" name="smiling" class="form-checkbox h-5 w-5 text-blue-600">
          </div>

          <div class="flex items-center justify-between">
            <label class="font-medium text-gray-700">Bugungi kun uchun ish rejangizga kiritilgan <br>  darslarni o'z vaqtida o'tdingizmi?</label>
            <input  type="checkbox" name="plan" class="form-checkbox h-5 w-5 text-blue-600">
          </div>

          <div class="flex items-center justify-between">
            <label class="font-medium text-gray-700">Jurnalni talab darajasida yuripsizmi?</label>
            <input  type="checkbox" name="journal" class="form-checkbox h-5 w-5 text-blue-600">
          </div>

          <div class="flex items-center justify-between">
            <label class="font-medium text-gray-700">O'zingizga biriktirilgan xonani <b>tozaligi,</b><br>
            <b>tartibli</b> ekanligini qarab chiqdingizmi?</label>
            <input  type="checkbox" name="cleanliness" class="form-checkbox h-5 w-5 text-blue-600">
          </div>

          <div class="flex items-center justify-between">
            <label class="font-medium text-gray-700">Dars qilib kelmagan o'quvchilaringizni <br> <i>tutoriga</i> aytib ogohlantirdingizmi?</label>
            <input  type="checkbox" name="report" class="form-checkbox h-5 w-5 text-blue-600">
          </div>
          <div>
            <label class="block font-medium text-gray-700">Bugun menga qanday taklifingiz bor? </label>
            <input required type="text" name="request" class="w-full border rounded px-3 py-1.5">
          </div>

       

          <div>
            <label class="block font-medium text-gray-700">Sana</label>
            <input required type="date" name="date" class="w-full border rounded px-3 py-1.5" required>
          </div>
        </div>
      </div>

      <footer class="mt-6">
        <div class="grid grid-cols-2 gap-6">
          <div class="space-y-2">
            <label class="block font-medium text-gray-700">Xodim  topshirdim</label>
            <input type="number" name="employee_signature" class="w-full border rounded px-3 py-1.5" maxlength="9" required>
          </div>

          <div class="space-y-2">
            <label class="block font-medium text-gray-700">Qabul qildim</label>
            <input maxlength="9" type="number" name="manager_signature" class="w-full border rounded px-3 py-1.5" required>
          </div>
        </div>

        <button type="submit" class="bg-blue-500 text-white font-bold py-2 px-6 rounded shadow-lg hover:bg-blue-600 transition duration-200 w-full mt-4">Отправить</button>
      </footer>
      
    </form>
  </div>

  <script>
    // function submitForm(event) {
    //   event.preventDefault();

    //   const formData = new FormData(event.target);
      
    //   fetch('https://script.google.com/macros/s/AKfycbzolLlGZPn89rrDxJHB21OjYHjk6s3QFn5TPj_vbBdg_tLVEC-yclrBcfPPk2yOy8AX/exec', {
    //     method: 'POST',
    //     body: formData
    //   })
    //   .then(response => response.text())
    //   .then(data => alert(data))
    //   .catch(error => alert('Произошла ошибка'));
    // }
    async function submitForm(event) {
  event.preventDefault();

  const form = event.target;
  const formData = new FormData(form);

  // Создание PDF перед отправкой
  const pdfContent = createPDF(form);

  // Скачивание PDF
  const pdfFileName = `CheckList-${formData.get('name') || 'Отправитель'}.pdf`;
  pdfContent.save(pdfFileName);

  // Отправка данных в Google Apps Script
  try {
    const response = await fetch('https://script.google.com/macros/s/AKfycbzolLlGZPn89rrDxJHB21OjYHjk6s3QFn5TPj_vbBdg_tLVEC-yclrBcfPPk2yOy8AX/exec', {
      method: 'POST',
      body: formData,
    });

    if (response.ok) {
      Swal.fire({
        title: 'Успешно!',
        text: 'Данные были отправлены. PDF сохранён.',
        icon: 'success',
        confirmButtonText: 'ОК',
      });
      form.reset();
    } else {
      throw new Error('Ошибка отправки данных.');
    }
  } catch (error) {
    Swal.fire({
      title: 'Ошибка!',
      text: 'Произошла ошибка при отправке данных.',
      icon: 'error',
      confirmButtonText: 'ОК',
    });
  }
}
function createPDF(form) {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  // Заголовок
  doc.setFontSize(18);
  doc.text('Check List', 105, 10, { align: 'center' });

  // Данные формы
  const formData = new FormData(form);
  const fields = Array.from(formData.entries());

  doc.setFontSize(12);
  let y = 20; // Начальная позиция по вертикали

  fields.forEach(([key, value]) => {
    if (key === 'employee_signature' || key === 'manager_signature') {
      // Для подписей добавьте отдельные строки
      doc.text(`${key}: (Подпись)`, 10, y);
      y += 10;
    } else {
      doc.text(`${key}: ${value || ''}`, 10, y);
      y += 10;
    }
  });

  // Подписи
  y += 10;
  doc.text('Подпись сотрудника: _______________________', 10, y);
  y += 10;
  doc.text('Подпись руководителя: _______________________', 10, y);

  return doc;
}



  </script>

</body>
</html>
  
